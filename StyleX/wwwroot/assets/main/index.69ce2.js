window.__require=function t(e,n,o){function r(c,a){if(!n[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var u="function"==typeof __require&&__require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){return r(e[c][1][t]||t)},l,l.exports,t,e,n,o)}return n[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<o.length;c++)r(o[c]);return r}({Board1Controller:[function(t,e,n){"use strict";cc._RF.push(e,"9ebc2OWAWRK9al3kCYe4GlU","Board1Controller");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reelPrefab=null,e}return r(e,t),e.prototype.start=function(){var t=cc.instantiate(this.reelPrefab),e=cc.instantiate(this.reelPrefab),n=cc.instantiate(this.reelPrefab);this.node.addChild(t),this.node.addChild(e),this.node.addChild(n),t.setPosition(new cc.Vec2(-145,0)),e.setPosition(new cc.Vec2(0,0)),n.setPosition(new cc.Vec2(145,0)),this.reel1Script=t.getComponent("ReelController"),this.reel2Script=e.getComponent("ReelController"),this.reel3Script=n.getComponent("ReelController"),this.reel2Script.typeSpin=1},e.prototype.startReel=function(){this.reel1Script.startReel(),this.reel2Script.startReel(),this.reel3Script.startReel()},e.prototype.setResult=function(t,e,n){this.reel1Script.setResult(t),this.reel2Script.setResult(e),this.reel3Script.setResult(n)},e.prototype.stopReel=function(){this.reel1Script.stopReel(),this.reel2Script.stopReel(),this.reel3Script.stopReel()},e.prototype.update=function(){},i([s(cc.Prefab)],e.prototype,"reelPrefab",void 0),i([a],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],ButtonQuayController:[function(t,e,n){"use strict";cc._RF.push(e,"b8f7fNIpCtBd4E0rz03lpx3","ButtonQuayController");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c},c=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function c(t){try{s(o.next(t))}catch(e){i(e)}}function a(t){try{s(o.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,a)}s((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(t){return function(e){return s([t,e])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=cc._decorator,u=s.ccclass,l=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SpriteON=null,e.SpriteOFF=null,e.isQuay=!1,e.numberQuay=0,e}return r(e,t),e.prototype.onLoad=function(){this.board1=cc.find("Canvas/Main Board/Mask 1/Board"),this.soLuotQuay=cc.find("Canvas/Main Board/board_number/soLuotQuay"),this.trungThuong=cc.find("Canvas/TrungThuong"),this.labelTrungThuong=cc.find("Canvas/TrungThuong/LabelTrungThuong"),this.mayManLanSau=cc.find("Canvas/MayManLanSau"),this.trungThuong.active=!1,this.mayManLanSau.active=!1},e.prototype.start=function(){this.board1.getComponent("Board1Controller").setResult(this.generateRandomArray(),this.generateRandomArray(),this.generateRandomArray());var t=new cc.Component.EventHandler;t.target=this.node,t.component="ButtonQuayController",t.handler="handleButtonQuay",t.customEventData="",this.node.getComponent(cc.Button).clickEvents.push(t),this.getNumberPlay()},e.prototype.handleButtonQuay=function(){return c(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.isQuay?[3,1]:(this.soLuotQuay.getComponent(cc.Label).string="C\xf2n "+(this.numberQuay-1)+" l\u01b0\u1ee3t",this.node.getComponent(cc.Sprite).spriteFrame=this.SpriteOFF,this.board1.getComponent("Board1Controller").startReel(),this.isQuay=!0,[3,4]);case 1:return this.node.getComponent(cc.Sprite).spriteFrame=this.SpriteON,[4,this.getResult()];case 2:return t.sent(),[4,this.getNumberPlay()];case 3:t.sent(),t.label=4;case 4:return[2]}})})},e.prototype.notifySpin=function(t){if(t>0){cc.find("Canvas/TrungThuong/LabelTrungThuong").getComponent(cc.RichText).string="<color=yellow >Ch\xfac m\u1eebng b\u1ea1n nh\u1eadn \u0111\u01b0\u1ee3c 1 phi\u1ebfu gi\u1ea3m gi\xe1 "+t+"%</color>",cc.find("Canvas/TrungThuong").active=!0;var e=setTimeout(function(){cc.find("Canvas/TrungThuong").active=!1,clearTimeout(e)},4e3)}else cc.find("Canvas/MayManLanSau").getComponent(cc.RichText).string="<color=green>Ch\xfac b\u1ea1n may m\u1eafn l\u1ea7n sau!</color>",cc.find("Canvas/MayManLanSau").active=!0,e=setTimeout(function(){cc.find("Canvas/MayManLanSau").active=!1,clearTimeout(e)},4e3)},e.prototype.getResult=function(){return c(this,void 0,void 0,function(){var t=this;return a(this,function(e){switch(e.label){case 0:return[4,fetch("/Promotion/GetResult",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then(function(t){return t.json()}).then(function(e){if(1==e.status)t.board1.getComponent("Board1Controller").setResult(e.result1,e.result2,e.result3),t.notifySpin(e.numberSale);else{cc.find("Canvas/MayManLanSau").getComponent(cc.RichText).string="<color=red>C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i sau!</color>",cc.find("Canvas/MayManLanSau").active=!0;var n=setTimeout(function(){cc.find("Canvas/MayManLanSau").active=!1,clearTimeout(n)},4e3)}t.board1.getComponent("Board1Controller").stopReel(),t.isQuay=!1}).catch(function(){cc.find("Canvas/MayManLanSau").getComponent(cc.RichText).string="<color=red>C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i sau!</color>",cc.find("Canvas/MayManLanSau").active=!0;var t=setTimeout(function(){cc.find("Canvas/MayManLanSau").active=!1,clearTimeout(t)},4e3)})];case 1:return e.sent(),[2]}})})},e.prototype.getNumberPlay=function(){return c(this,void 0,void 0,function(){var t=this;return a(this,function(e){switch(e.label){case 0:return[4,fetch("/Promotion/GetNumberPlay",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then(function(t){return t.json()}).then(function(e){t.numberQuay=e.number,t.soLuotQuay.getComponent(cc.Label).string="C\xf2n "+e.number+" l\u01b0\u1ee3t",e.number>0?t.node.active=!0:t.node.active=!1}).catch(function(){t.soLuotQuay.getComponent(cc.Label).string="H\u1ec7 th\u1ed1ng b\u1eadn",t.node.active=!1})];case 1:return e.sent(),[2]}})})},e.prototype.generateRandomArray=function(){for(var t=[];t.length<7;){var e=Math.floor(7*Math.random())+1;-1==t.indexOf(e)&&t.push(e)}return t},i([l(cc.SpriteFrame)],e.prototype,"SpriteON",void 0),i([l(cc.SpriteFrame)],e.prototype,"SpriteOFF",void 0),i([u],e)}(cc.Component);n.default=p,cc._RF.pop()},{}],ItemController:[function(t,e,n){"use strict";cc._RF.push(e,"38036/CCjdC/r8211GcuwIZ","ItemController");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Id=0,e}return r(e,t),e.prototype.start=function(){},i([s(cc.Integer)],e.prototype,"Id",void 0),i([a],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],ReelController:[function(t,e,n){"use strict";cc._RF.push(e,"53361wR7ilGdapsomeLTMjI","ReelController");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeItems=[],e.minHeightPosition=-405,e.maxHeightPosition=405,e.heightItem=135,e.isRunning=!1,e.isChangeResult=!1,e.typeSpin=0,e.spinSpeed=27,e.result=[1,2,3,4,5,6,7],e}return r(e,t),e.prototype.start=function(){this.nodeItems=this.node.children},e.prototype.update=function(){0==this.isRunning?this.changeResult():this.spin()},e.prototype.spin=function(){0==this.typeSpin?this.spinDown():this.spinUp()},e.prototype.spinUp=function(){var t,e=this;this.nodeItems.forEach(function(t){var n=t.getPosition();t.setPosition(n.x,n.y+e.spinSpeed)});var n=this.nodeItems.map(function(t){return t.getPosition().y}),o=(t=this.nodeItems.find(function(t){return t.getPosition().y===Math.max.apply(Math,n)})).getPosition();o.y==this.maxHeightPosition+this.heightItem&&t.setPosition(o.x,this.minHeightPosition)},e.prototype.spinDown=function(){var t,e=this;this.nodeItems.forEach(function(t){var n=t.getPosition();t.setPosition(n.x,n.y-e.spinSpeed)});var n=this.nodeItems.map(function(t){return t.getPosition().y}),o=(t=this.nodeItems.find(function(t){return t.getPosition().y===Math.min.apply(Math,n)})).getPosition();o.y==this.minHeightPosition-this.heightItem&&t.setPosition(o.x,this.maxHeightPosition)},e.prototype.startReel=function(){0==this.isRunning&&(this.isRunning=!0)},e.prototype.stopReel=function(){1==this.isRunning&&(this.isRunning=!1)},e.prototype.setResult=function(t){this.result=t,this.isChangeResult=!0},e.prototype.changeResult=function(){var t=this;if(this.isChangeResult){for(var e=function(e){n.nodeItems.find(function(n){return n.getComponent("ItemController").Id==t.result[e]}).setPosition(0,n.maxHeightPosition-n.heightItem*e)},n=this,o=0;o<this.result.length;o++)e(o);this.isChangeResult=!1}},e.prototype.getValues=function(){var t=[];return t.push(this.nodeItems.find(function(t){return 135==t.getPosition().y}).getComponent("ItemController").Id),t.push(this.nodeItems.find(function(t){return 0==t.getPosition().y}).getComponent("ItemController").Id),t.push(this.nodeItems.find(function(t){return-135==t.getPosition().y}).getComponent("ItemController").Id),t},i([a],e)}(cc.Component));n.default=s,cc._RF.pop()},{}]},{},["Board1Controller","ButtonQuayController","ItemController","ReelController"]);